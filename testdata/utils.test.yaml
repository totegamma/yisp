# RFC6902
# add - object member replacement (existing member)
!yisp
- maps.patch
- hoge: 0
- !quote
  - op: add
    path: /hoge
    value: 1
  - op: add
    path: /piyo
    value: 2
# hoge: 1
# piyo: 2
---
# add - array index insertion
!yisp
- maps.patch
- !quote
  items:
    - a
    - b
    - d
- !quote
  - op: add
    path: /items/2
    value: c
# items: [a, b, c, d]
---
# add - array append
!yisp
- maps.patch
- !quote
  items:
    - a
    - b
- !quote
  - op: add
    path: /items/2
    value: c
# items: [a, b, c]
---
# add - array append using "-"
!yisp
- maps.patch
- !quote
  items:
    - x
    - y
- !quote
  - op: add
    path: /items/-
    value: z
# items: [x, y, z]
---
# remove - object member
!yisp
- maps.patch
- hoge: 1
  piyo: 2
- !quote
  - op: remove
    path: /hoge
# piyo: 2
---
# remove - array element
!yisp
- maps.patch
- !quote
  items:
    - a
    - b
    - c
- !quote
  - op: remove
    path: /items/1
# items: [a, c]
---
# move - object member
!yisp
- maps.patch
- hoge: 1
  piyo: 2
- !quote
  - op: move
    path: /piyo
    from: /hoge
# piyo: 1
---
# move - array element
!yisp
- maps.patch
- !quote
  items:
    - a
    - b
    - c
- !quote
  - op: move
    from: /items/0
    path: /items/2
# items: [b, c, a]
---
# copy
!yisp
- maps.patch
- hoge: 1
  piyo: 2
- !quote
  - op: copy
    path: /piyo
    from: /hoge
# hoge: 1
# piyo: 1
---
# wildcard - add to all map entries
!yisp
- maps.patch
- !quote
  resource:
    my-object0:
      attr: hoge
    my-object1:
      attr: piyo
- !quote
  - op: add
    path: /resource/*
    value:
      tag: my-tag
# resource:
#   my-object0:
#     attr: hoge
#     tag: my-tag
#   my-object1:
#     attr: piyo
#     tag: my-tag
---
# wildcard - replace all map entries
!yisp
- maps.patch
- !quote
  items:
    item1: old-value1
    item2: old-value2
- !quote
  - op: replace
    path: /items/*
    value: new-value
# items:
#   item1: new-value
#   item2: new-value
---
# wildcard - remove specific field from all entries
!yisp
- maps.patch
- !quote
  data:
    entry1:
      name: first
      temp: remove-me
    entry2:
      name: second
      temp: remove-me
- !quote
  - op: remove
    path: /data/*/temp
# data:
#   entry1:
#     name: first
#   entry2:
#     name: second
---
# wildcard - add to all array elements
!yisp
- maps.patch
- !quote
  items:
    - name: item1
    - name: item2
    - name: item3
- !quote
  - op: add
    path: /items/*
    value:
      enabled: true
# items:
#   - name: item1
#     enabled: true
#   - name: item2
#     enabled: true
#   - name: item3
#     enabled: true
---
# wildcard - replace all array elements
!yisp
- maps.patch
- !quote
  values:
    - old1
    - old2
    - old3
- !quote
  - op: replace
    path: /values/*
    value: replaced
# values:
#   - replaced
#   - replaced
#   - replaced
---
# wildcard in middle - add field to nested objects
!yisp
- maps.patch
- !quote
  resource:
    server1:
      labels:
        env: prod
    server2:
      labels:
        env: dev
- !quote
  - op: add
    path: /resource/*/labels/team
    value: platform
# resource:
#   server1:
#     labels:
#       env: prod
#       team: platform
#   server2:
#     labels:
#       env: dev
#       team: platform
---
# wildcard in middle - merge multiple fields preserving existing
!yisp
- maps.patch
- !quote
  resource:
    aws_instance:
      example0:
        tags:
          Name: instance-0
      example1:
        tags:
          Name: instance-1
- !quote
  - op: add
    path: /resource/aws_instance/*/tags
    value:
      Environment: Production
      Owner: DevOps
# resource:
#   aws_instance:
#     example0:
#       tags:
#         Name: instance-0
#         Environment: Production
#         Owner: DevOps
#     example1:
#       tags:
#         Name: instance-1
#         Environment: Production
#         Owner: DevOps
---
# single patch object input (not array)
!yisp
- maps.patch
- hoge: 0
  piyo: 1
- op: add
  path: /fuga
  value: 2
# hoge: 0
# piyo: 1
# fuga: 2
